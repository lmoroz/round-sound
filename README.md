# Round Sound Widget

–ö—Ä—É–≥–ª—ã–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –≤–∏–¥–∂–µ—Ç –¥–ª—è Windows —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π audio levels.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üéµ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç—Ä–µ–∫–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∞—Ä—Ç–∏—Å—Ç, –æ–±–ª–æ–∂–∫–∞)
- üéÆ –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (play/pause, next, previous, shuffle, repeat, like/dislike)
- üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è audio levels "–ª—É—á–∞–º–∏" –≤–æ–∫—Ä—É–≥ –≤–∏–¥–∂–µ—Ç–∞ (FFT-–∞–Ω–∞–ª–∏–∑ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
- üñºÔ∏è –ö—Ä—É–≥–æ–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
- ü™ü –ü—Ä–æ–∑—Ä–∞—á–Ω–æ–µ frameless –æ–∫–Ω–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ desktop
- üíæ –ó–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –æ–∫–Ω–∞ –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏
- üé® –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ FFT
- üîî –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å system tray (—Å–∫—Ä—ã—Ç–∏–µ –≤ —Ç—Ä–µ–π –≤–º–µ—Å—Ç–æ –∑–∞–∫—Ä—ã—Ç–∏—è)
- üöÄ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ Windows

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Backend
- **Go 1.21+**
- **Wails v2** ‚Äî –¥–µ—Å–∫—Ç–æ–ø–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **gorilla/websocket** ‚Äî WebSocket –¥–ª—è WebNowPlaying
- **go-wca** ‚Äî WASAPI –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ audio levels

### Frontend
- **Vue.js 3** + Composition API
- **TypeScript**
- **Vite 7**
- **Lucide Icons**
- **Canvas** –¥–ª—è audio levels

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
round-sound/
‚îú‚îÄ‚îÄ main.go                 # Entry point Wails
‚îú‚îÄ‚îÄ wails.json              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Wails
‚îú‚îÄ‚îÄ go.mod                  # Go –º–æ–¥—É–ª—å
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ app.go              # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config.go           # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ window.go           # Window manager (–æ–±—â–∏–π)
‚îÇ   ‚îî‚îÄ‚îÄ window_windows.go   # Windows-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ (HWND_BOTTOM)
‚îú‚îÄ‚îÄ media/
‚îÇ   ‚îú‚îÄ‚îÄ types.go            # –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö Player
‚îÇ   ‚îú‚îÄ‚îÄ webnowplaying.go    # WebSocket server –¥–ª—è WebNowPlaying
‚îÇ   ‚îî‚îÄ‚îÄ audiolevels.go      # WASAPI audio capture
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CircularWidget.vue
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AlbumCover.vue
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TrackInfo.vue
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProgressRing.vue
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AudioLevelsRays.vue
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MediaControls.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ composables/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useMediaPlayer.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useAudioLevels.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.ts
‚îî‚îÄ‚îÄ docs/
    ‚îú‚îÄ‚îÄ todo.md
    ‚îî‚îÄ‚îÄ WebNowPlaying-Protocol.md
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Go 1.21+
- Node.js 20+
- Wails CLI (`go install github.com/wailsapp/wails/v2/cmd/wails@latest`)

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd frontend && npm install && cd ..
go mod tidy

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ dev —Ä–µ–∂–∏–º–µ
wails dev
```

### –°–±–æ—Ä–∫–∞
```bash
wails build
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WebNowPlaying

–í–∏–¥–∂–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±—Ä–∞—É–∑–µ—Ä–Ω—ã–º –ø–ª–∞–≥–∏–Ω–æ–º [WebNowPlaying](https://wnp.keifufu.dev/):
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–ª–∞–≥–∏–Ω –≤ Chrome/Firefox
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Round Sound
3. –û—Ç–∫—Ä–æ–π—Ç–µ YouTube Music, Spotify Web –∏–ª–∏ –¥—Ä—É–≥–æ–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Å–µ—Ä–≤–∏—Å

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- YouTube Music
- Spotify Web
- SoundCloud
- Deezer
- Tidal
- Apple Music
- –ò –¥—Ä—É–≥–∏–µ...

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Desktop-level –æ–∫–Ω–æ
–í–∏–¥–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞ (–Ω–∏–∂–µ –≤—Å–µ—Ö –æ–∫–æ–Ω) —Å –ø–æ–º–æ—â—å—é:
- Windows API `SetWindowPos` —Å `HWND_BOTTOM`
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Z-order –∫–∞–∂–¥—ã–µ 500ms

### Partial Updates

WebNowPlaying –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è. Backend —Ö—Ä–∞–Ω–∏—Ç –ø–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç merge.

### Audio Levels (WASAPI)

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—É–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Windows Core Audio API:

- –ó–∞—Ö–≤–∞—Ç –∞—É–¥–∏–æ-–ø–æ—Ç–æ–∫–∞ —á–µ—Ä–µ–∑ WASAPI loopback (`IAudioCaptureClient`)
- Real-time FFT-–∞–Ω–∞–ª–∏–∑ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `github.com/mjibson/go-dsp/fft`
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Hann window –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è spectral leakage
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ FFT bins –≤ 64 —á–∞—Å—Ç–æ—Ç–Ω—ã–µ –ø–æ–ª–æ—Å—ã (20Hz - 20kHz) —Å –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π —à–∫–∞–ª–æ–π
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ FFT size (1024/2048/4096/8192) –∏ —á–∞—Å—Ç–æ—Ç–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ frontend ~60 FPS —á–µ—Ä–µ–∑ Wails Events

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–Ω—è—Ç–æ–≥–æ –ø–æ—Ä—Ç–∞

–ï—Å–ª–∏ –ø–æ—Ä—Ç 8974 –∑–∞–Ω—è—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, Rainmeter), –≤—ã–≤–æ–¥–∏—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
